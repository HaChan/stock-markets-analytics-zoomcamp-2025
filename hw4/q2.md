Calculating sumulation for prediction pred20_rf_best_rule_64:
    Count times of investment 3702 out of 31408 TEST records
/home/hachan/datatalksclub/stock-markets-analytics-zoomcamp-2025/trading_simulations.py:779: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  new_df['sim1_gross_rev_'+pred_prefix] = new_df[pred] * 100 * (new_df['growth_future_30d']-1)
/home/hachan/datatalksclub/stock-markets-analytics-zoomcamp-2025/trading_simulations.py:780: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  new_df['sim1_fees_'+pred_prefix] = -new_df[pred] * 100 * 0.002
/home/hachan/datatalksclub/stock-markets-analytics-zoomcamp-2025/trading_simulations.py:781: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  new_df['sim1_net_rev_'+pred_prefix] = new_df['sim1_gross_rev_'+pred_prefix] + new_df['sim1_fees_'+pred_prefix]
    Financial Result:
 sim1_gross_rev_pred20    10473.99787
sim1_fees_pred20          -740.40000
sim1_net_rev_pred20       9754.79787
dtype: float64
        Count Investments in 4 years (on TEST): 3702
        Gross Revenue: $10473
        Fees (0.2% for buy+sell): $740
        Net Revenue: $9754
        Fees are 7 % from Gross Revenue
        Capital Required : $21000 (Vbegin)
        Final value (Vbegin + Net_revenue) : $30754 (Vfinal)
        Average CAGR on TEST (4 years) : 1.1, or 10.0%
        Average daily stats:
            Average net revenue per investment: $2.64
            Average investments per day: 5
            Q75 investments per day: 7

>>> df_sim = trading_simulations.df_sim1_results[trading_simulations.df_sim1_results.prediction.str.contains(pattern, na=False)]
>>> df_sim
                prediction  sim1_count_investments  sim1_gross_rev  sim1_fees  sim1_net_rev  ...  sim1_average_net_revenue  sim1_avg_investments_per_day  sim1_capital  sim1_CAGR  sim1_growth_capital_4y
10  pred10_rf_best_rule_55                   16967    36623.350836    -3393.4  33335.150836  ...                  1.964705                     17.242886       72000.0   1.099791                1.462988
11  pred11_rf_best_rule_65                    2869     8135.220044     -573.8   7577.620044  ...                  2.641206                      4.496865       18000.0   1.091810                1.420979
12  pred12_rf_best_rule_56                   15199    33363.780517    -3039.8  30418.980517  ...                  2.001380                     15.477597       66000.0   1.099397                1.460894
13  pred13_rf_best_rule_57                   13506    30632.340120    -2701.2  28015.140120  ...                  2.074274                     13.838115       60000.0   1.100529                1.466919
14  pred14_rf_best_rule_58                   11847    26948.603962    -2369.4  24655.403962  ...                  2.081152                     12.276684       54000.0   1.098585                1.456582
15  pred15_rf_best_rule_59                   10156    23259.106610    -2031.2  21291.106610  ...                  2.096407                     10.769883       48000.0   1.096122                1.443565
16  pred16_rf_best_rule_60                    8671    20137.811791    -1734.2  18458.011791  ...                  2.128706                      9.486871       42000.0   1.095346                1.439476
17  pred17_rf_best_rule_61                    7183    17026.965641    -1436.6  15634.365641  ...                  2.176579                      8.190422       36000.0   1.094357                1.434288
18  pred18_rf_best_rule_62                    5866    14539.067246    -1173.2  13400.467246  ...                  2.284430                      7.075995       30000.0   1.096714                1.446682
19  pred19_rf_best_rule_63                    4728    12240.415820     -945.6  11323.415820  ...                  2.394970                      6.100645       25500.0   1.096216                1.444056
20  pred20_rf_best_rule_64                    3702    10473.997870     -740.4   9754.797870  ...                  2.635008                      5.206751       21000.0   1.100078                1.464514
